# Boussole dâ€™Ã©tat â€“ 14â€¯maiâ€¯2025 (pivot Â«â€¯LangFlowÂ â†’â€¯Builder maisonâ€¯Â»)

---

## 1. Point de dÃ©part & vision gÃ©nÃ©rale

| Ã‰lÃ©ment                  | Contenu mis Ã  jour                                                                                                                                                                                                                                                                |
| ------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Objectif stratÃ©gique** | Construire un SaaS dâ€™orchestration dâ€™agentsâ€¯IA **100â€¯% openâ€‘source**, dÃ©ployable **cloud â†’ Docker local**, avec contrÃ´le humain progressif puis montÃ©e vers lâ€™autonomie.                                                                                                          |
| **MÃ©taphore directrice** | **Maisons prÃ©fabriquÃ©es** (stack Docker client) + **atelier LEGO** (LangFlow) + **table Ã  dessin** (Reactâ€‘Flowâ€¯Builder).                                                                                                                                                          |
| **Environnement de dev** | Windowsâ€¯10Â (i7â€‘8750H,â€¯16â€¯Goâ€¯RAM), DockerÂ Desktop, GitHub monorepo.                                                                                                                                                                                                                |
| **Stack cÅ“ur**           | â€¢ **LangFlow** (catalogue & moteur) â€¢ **BuilderÂ maison** (nÅ“ud dÃ©clencheur, Reactâ€‘FlowÂ +Â Node.js) â€¢ **CompilerÂ Service** (Jinjaâ€¯2) â€¢ **LangGraphÂ /Â CrewAIâ€¯/â€¯Llamaâ€‘Index** â€¢ **PhoenixÂ /Â OTEL** (observabilitÃ©).                                                                   |
| **Pipeline magique**     | 1. Lâ€™utilisateur dessine un flow (LangFlow **ou** Reactâ€‘Flowâ€¯Builder). 2. **Save**Â â†’ JSON envoyÃ© Ã  **/build**. 3. CompilerÂ Service gÃ©nÃ¨re / met Ã  jour `app/flows/<slug>.py` + hotâ€‘reload LangServe. 4. **NÅ“ud dÃ©clencheur Builder** appelle `/runâ€‘<slug>` pour exÃ©cuter le flow. |

---

## 2. Historique condensÃ© des actions clÃ©s

| Date       | Action                                                                  | RÃ©sultat                          |
| ---------- | ----------------------------------------------------------------------- | --------------------------------- |
| 2025â€‘05â€‘08 | Stack **ActivePiecesâ€¯0.39â€¯CE** initiale                                 | UI OK (monoâ€‘project).             |
| 2025â€‘05â€‘10 | **Pivot ScÃ©narioâ€¯B**Â : 1Â stackÂ /Â client (maison prÃ©fab.)                | Licenceâ€¯GPL respectÃ©e.            |
| 2025â€‘05â€‘11 | Ajout **LangFlow** + tests export JSON â†’ Compiler â†’ Phoenix             | ChaÃ®ne dâ€™exÃ©cution validÃ©e.       |
| 2025â€‘05â€‘12 | Conception **Reactâ€‘FlowÂ Builder** (Next.jsâ€¯+â€¯Tailwind) & API `/catalog` | Catalogue dynamique opÃ©rationnel. |
| 2025â€‘05â€‘14 | **Migration complÃ¨te ActivePieces â†’ BuilderÂ maison**                    | Unique dÃ©clencheur, stack Ã©purÃ©e. |

---

## 3. Douleurs & raisons du pivot

| ProblÃ¨me                                      | Impact                         | Solution Â«â€¯LangFlowÂ â†’Â BuilderÂ maisonâ€¯Â»                                                                      |
| --------------------------------------------- | ------------------------------ | ----------------------------------------------------------------------------------------------------------- |
| UI LangFlow non brandable, pas de rÃ´les fin   | Look & feel hÃ©tÃ©roclite        | Builder Reactâ€‘Flow skinnable + IAM minimale (token).                                                        |
| Ajout dâ€™un bloc = fork / PR upstream LangFlow | Friction, dÃ©lais               | Conserver LangFlow comme **moteurÂ &Â registry**, exposer directement le catalogue au Builder â†’ plus de fork. |
| **Double logique gÃ©nÃ©rÃ©e par ActivePieces**   | ComplexitÃ©, maintenance double | Suppression totaleÂ : **BuilderÂ maison devient lâ€™unique point dâ€™entrÃ©e**.                                    |

---

## 4. Architecture cible (ScÃ©narioâ€¯Bâ€¯v3)

```
monorepo/
  main/                <- toolbox, CompilerÂ Service, LangFlow registry
  builder-front/       <- Reactâ€‘Flow Builder (Next.js)
  tenant/<slug>/       <- flows .json + .py gÃ©nÃ©rÃ©s pour le client
compose/<slug>/
  â”œ builder-api (31xx)
  â”œ langserve   (80xx)
  â”œ phoenix     (14xx)
  â”œ postgres, redis
  â”” langflow    (78xx)   # interne, non exposÃ© public
```

**Flux rÃ©sumÃ©**

1. **Client** ouvre Builder â†’ GET `/catalog` (venant du registryÂ LangFlow).
2. Dessine, clique **Save**Â â†’ POST `/build` avec le flow JSON.
3. **CompilerÂ Service** gÃ©nÃ¨re / met Ã  jour `app/flows/<slug>.py`, hotâ€‘reload LangServe.
4. **NÅ“ud dÃ©clencheur Builder** appelle `/runâ€‘<slug>`.
5. Phoenix trace toutes les spans.

---

## 5. Ã‰cartÂ CE vs besoins & contournements

> **\[OBSOLETE â€“ remplacÃ© par Builder]**

| Fonction manquante CE | Contournement                                    |
| --------------------- | ------------------------------------------------ |
| Multiâ€‘project         | 1Â compose = 1Â client                             |
| RBAC UI               | Confiance interne + Builder gÃ¨re un token simple |
| UI Pieces/Templates   | Ajout / mise Ã  jour via rebuild de lâ€™image       |

---

## 6. Documentation Ã  mettre Ã  jour

| Fichier                 | Action                                                                                         |
| ----------------------- | ---------------------------------------------------------------------------------------------- |
| **activepieces\_4A.md** | **\[OBSOLETE â€“ remplacÃ© par Builder]**                                                         |
| **workflows.md**        | Mettre Ã  jour diagramme LangFlowÂ â†’Â BuilderÂ â†’Â CompilerÂ ; supprimer mention â€œPiece gÃ©nÃ©ratriceâ€. |
| *Legostudio*.md         | Remplacer immeubleÂ LEGO par **maisons + atelier + table Ã  dessin**.                            |
| **README**              | Pointer vers cette boussole version 14â€‘05â€‘2025.                                                |

---

## 7. TODO technique courtâ€‘terme (3Â semaines)

| Prio | Action                                                          | Commande clÃ© (YAML)                                  |
| ---- | --------------------------------------------------------------- | ---------------------------------------------------- |
| 1    | **Installer LangFlow** dans stack modÃ¨le + tests export/run     | `docker compose up -d langflow`                      |Fait
| 2    | **Ajouter nÅ“ud dÃ©clencheur Builder** (TS) + build `builder-api` | `pnpm run build && docker compose build builder-api` |a faire
| 3    | **Route /catalog** dans CompilerÂ Service                        | `uvicorn compiler_service.api:app`                   |
| 4    | **Skeleton Reactâ€‘Flow Builder** (Next.jsâ€¯14) + fetch catalog    | `npm create next-app builder-front`                  |
| 5    | **Hotâ€‘reload** LangServe via signals                            | incl. in CompilerÂ Service                            |

---

## 8. Roadmap 6Â semaines (rÃ©visÃ©e)

| Semaine | Livrable                                              | Image LEGO                       |
| ------- | ----------------------------------------------------- | -------------------------------- |
| 1       | LangFlow installÃ© + tests unitaires RAG simple        | **Moteur montÃ© sur chÃ¢ssis**     |
| 2       | **NÅ“ud dÃ©clencheur Builder** + premier flow dÃ©clenchÃ© | **Interrupteur reliÃ© au moteur** |
| 3       | Reactâ€‘FlowÂ Builder MVP (catalogue & save)             | **Table Ã  dessin personnalisÃ©e** |
| 4       | Flows RAG complexes + CrewAI (vote)                   | **Turbo & tÃ©lÃ©mÃ©trie**           |
| 5       | Edgeâ€‘agents locaux (scripts PC) exposÃ©s               | **Bras robotisÃ© dans lâ€™atelier** |
| 6       | Documentation complÃ¨te + onboarding 1er client pilote | **Maison tÃ©moin dÃ©corÃ©e**        |

---

### Conclusion

Le nouveau capÂ : **LangFlow = moteur & catalogue**, **Reactâ€‘Flow Builder = interface UX**, **BuilderÂ maison = dÃ©clencheur unique**. On progresse par incrÃ©mentsÂ : installer â†’ tester â†’ builder UI â†’ complexifier â†’ edgeâ€‘agents.

> **Pivot validÃ© 14â€¯maiâ€¯2025.**

---

## ğŸ“ Changelog

| Version  | Date       | Motif                                                                                      |
| -------- | ---------- | ------------------------------------------------------------------------------------------ |
| **v1.2** | 2025â€‘05â€‘14 | Migration complÃ¨te ActivePieces â†’ BuilderÂ maison ; refonte pipeline & architecture         |
| v1.1     | 2025â€‘05â€‘10 | PremiÃ¨re adaptation ScÃ©narioâ€¯B (Reactâ€‘Flow Builder) **\[OBSOLETE â€“ remplacÃ© par Builder]** |
| v1.0     | 2025â€‘05â€‘10 | Version initiale (pivot ScÃ©narioâ€¯B)                                                        |
